<!DOCTYPE html>
<html lang="pl">
<head>
	<title>Zadanie6 JavaScript - CallBack</title>
	<meta charset="utf-8">
</head>
<body>
	<div id="box"></div>
	<script type="text/javascript">
		//system rejestracji użytkownika
		//1. Wysyłanie danych uzytkownika na serwer....
		//2. Walidacja danych...
		//3. Rejestracja uzytkownika...
		//4. Wysyła maila z potwierdzeniem...
		//!!!! Kolejność jest ważna

		//var uzytkownik = {
		//	nazwa:'Arkadiusz Waliczek'
		//}

		const sentUserData = () => {
			return new Promise((rozwiazanie,error)=>{
				setTimeout(()=>{
					document.getElementById('box').innerHTML += "1. Wysyłanie danych uzytkownika na serwer....<br>";
					rozwiazanie({nazwa:'Arkadiusz Waliczek'});
				},3000)
			})
		}

		const validateData = (uzytkownik) => {
			return new Promise((rozwiazanie,error)=>{	
				setTimeout(()=>{
					document.getElementById('box').innerHTML += "2. Walidacja danych...<br>";
					rozwiazanie({nazwa:uzytkownik.nazwa,id:2});
				},2500)
			})
		}

		const registerUser = (uzytkownik) => {
			return new Promise((rozwiazanie,error)=>{
				setTimeout(()=>{
					document.getElementById('box').innerHTML +="3. Rej. uzytkownika: "+uzytkownik.nazwa+ " " + uzytkownik.id + "<br>";
					rozwiazanie();
				},1500)
			})
		}

		const sendMail = () => {
			return new Promise((rozwiazanie,error)=>{
				setTimeout(()=>{
					document.getElementById('box').innerHTML += "4. Wysyła maila z potwierdzeniem...<br>";
					rozwiazanie("Email został wysłany");
				},1000)
			})
		}

		sentUserData()
			.then(nazwaUzytkownika=>{
				return validateData(nazwaUzytkownika);
			})
			.then(registerU=>{
				return registerUser(registerU);
			})
			.then(()=>{
				return sendMail();
				console.log("Zakończono przekazywanie operacji właściwości");
			})

	</script>
</body>
</html>